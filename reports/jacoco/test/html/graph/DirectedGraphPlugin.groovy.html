<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DirectedGraphPlugin.groovy</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">graph-dsl</a> &gt; <a href="index.source.html" class="el_package">graph</a> &gt; <span class="el_source">DirectedGraphPlugin.groovy</span></div><h1>DirectedGraphPlugin.groovy</h1><pre class="source lang-java linenums">package graph

/**
 * This plugin makes a Graph behave like a directed graph.
 */
class DirectedGraphPlugin implements Plugin {

    /**
     * The following modifications are made to the graph:
     * &lt;p&gt;
     * members
     * edges - converted to DirectedEdges
     * edgeFactory - changed to a DirectedEdgeFactory
     * &lt;p&gt;
     * methods
     * The static graph methods in this class are added to the graph with graph as the first parameter.
     * @param graph
     * @return
     */
    void apply(Graph graph) {
<span class="fc" id="L21">        graph.@edges = graph.@edges.collect { edge -&gt;</span>
<span class="pc" id="L22">            new DirectedEdge(one:edge.one, two:edge.two)</span>
        } as LinkedHashSet

<span class="fc" id="L25">        graph.edgeFactory = new DirectedEdgeFactory()</span>

<span class="fc" id="L27">        graph.metaClass.inEdges = this.&amp;inEdges.curry(graph)</span>
<span class="fc" id="L28">        graph.metaClass.inDegree = this.&amp;inDegree.curry(graph)</span>
<span class="fc" id="L29">        graph.metaClass.outEdges = this.&amp;outEdges.curry(graph)</span>
<span class="fc" id="L30">        graph.metaClass.outDegree = this.&amp;outDegree.curry(graph)</span>
<span class="fc" id="L31">        graph.metaClass.traverseEdges = this.&amp;traverseEdges.curry(graph)</span>
<span class="fc" id="L32">        graph.metaClass.reversePostOrderSort = this.&amp;reversePostOrderSort.curry(graph)</span>
<span class="fc" id="L33">        graph.metaClass.reversePostOrder = this.&amp;reversePostOrder.curry(graph)</span>
    }

    /**
     * Returns in edges from vertex with name in graph.
     * @param graph
     * @param name
     * @return
     */
    static Set&lt;? extends Edge&gt; inEdges(Graph graph, String name) {
<span class="pc" id="L43">        graph.@edges.findAll {</span>
<span class="pc" id="L44">            name == it.two</span>
        }
    }

    /**
     * returns number of in edges from vertex with name in graph.
     * @param graph
     * @param name
     * @return
     */
    static int inDegree(Graph graph, String name) {
<span class="pc" id="L55">        graph.inEdges(name).size()</span>
    }

    /**
     * returns out edges with vertex name in graph.
     * @param graph
     * @param name
     * @return
     */
    static Set&lt;? extends Edge&gt; outEdges(Graph graph, String name) {
<span class="pc" id="L65">        graph.@edges.findAll {</span>
<span class="pc" id="L66">            name == it.one</span>
        }
    }

    /**
     * returns number of out edges with vertex name in graph.
     * @param graph
     * @param name
     * @return
     */
    static int outDegree(Graph graph, String name) {
<span class="pc" id="L77">        graph.outEdges(name).size()</span>
    }

    /**
     * returns out edges with vertex name in graph. This method replaces adjacentEdges in {@link Graph}.
     * @param graph
     * @param name
     * @return
     */
    static Set&lt;? extends Edge&gt; traverseEdges(Graph graph, String name) {
<span class="pc" id="L87">        graph.outEdges(name)</span>
    }

    /**
     * Returns the names of vertices sorted in reverse post order for the given graph.
     * @param graph
     * @return
     */
    static Deque&lt;String&gt; reversePostOrderSort(Graph graph) {
<span class="fc" id="L96">        Deque&lt;String&gt; deque = [] as LinkedList&lt;String&gt;</span>
<span class="fc" id="L97">        graph.depthFirstTraversal {</span>
<span class="pc" id="L98">            postorder { vertex -&gt;</span>
<span class="pc" id="L99">                deque.addFirst(vertex.name)</span>
            }
        }
<span class="pc" id="L102">        deque</span>
    }

    /**
     * Runs the given closure on each vertex in graph in reverse post order.
     * @param graph
     * @param closure
     */
    static void reversePostOrder(Graph graph, Closure closure) {
<span class="fc" id="L111">        Deque&lt;String&gt; deque = graph.reversePostOrderSort()</span>
<span class="fc" id="L112">        deque.each {</span>
<span class="pc" id="L113">            closure(graph.@vertices[it])</span>
        }
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.7.8.201612092310</span></div></body></html>